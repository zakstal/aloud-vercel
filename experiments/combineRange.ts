
const tokensIn = [
    {
        "text": "BARBERSHOP WARS",
        "type": "action"
    },
    {
        "type": "dialogue_begin"
    },
    {
        "text": "WRITTEN BY",
        "type": "character"
    },
    {
        "text": "LEE H. ROSS",
        "type": "dialogue"
    },
    {
        "type": "dialogue_end"
    },
    {
        "text": "CONTENTPLATION@ICLOUD.COM 323-445-6828 ALL RIGHTS RESERVED. COPY RIGHT MAY 2020 \fFADE IN:",
        "type": "action"
    },
    {
        "type": "editNode",
        "id": "48jkr"
    },
    {
        "text": "INT. MORNING - CAFE",
        "type": "scene_heading"
    },
    {
        "text": "CLOSE: milk steaming at an espresso machine, hipster BARISTA makes magic coffee.",
        "type": "action"
    },
    {
        "type": "editNode",
        "id": "aftwu"
    },
    {
        "text": "EXT. CAFE/BARBER SHOP - MORNING - MOMENTS LATER",
        "type": "scene_heading"
    },
    {
        "text": "MANBUN unlocks his BARBERSHOP, places his leather shoulder bag down.",
        "type": "action"
    },
    {
        "text": "Manbun relaxes with his expresso out front on the patio, unconsciously touching his curling mustache.",
        "type": "action"
    },
    {
        "text": "In the BG, the adjacent CAFE patio, locals chit chatting, mountain bikes and coolness.",
        "type": "action"
    },
    {
        "text": "Interrupting Manbun’s morning, loud thumping BASS speakers. A matte black monster TRUCK pulls up across the street.",
        "type": "action"
    },
    {
        "text": "Exiting the truck in shades, all black, is SKINHEAD. Keys unlock a 2nd BARBER SHOP opposite Manbun.",
        "type": "action"
    },
    {
        "text": "Next to Skinhead’s shack is an old school SKATEPARK, punks with boards loitering, waiting for their leader, Skinhead.",
        "type": "action"
    },
    {
        "text": "Manbun ignores Skinhead.",
        "type": "action"
    },
    {
        "text": "Skinhead drags a beat up metal folding CHAIR out front, metal music blares from his shop.",
        "type": "action"
    },
    {
        "text": "Skinhead looks directly at Manbun, as the first punk sits down.",
        "type": "action"
    },
    {
        "text": "Manbun slowly stands with his espresso, stares back at Skinhead, then enters his barbershop.",
        "type": "action"
    },
    {
        "text": "INT. MANBUN BARBERSHOP - DAY",
        "type": "scene_heading"
    },
    {
        "text": "Manbun snips artfully at SOYBOY’s hair.",
        "type": "action"
    },
    {
        "type": "dialogue_begin"
    },
    {
        "text": "SOYBOY",
        "type": "character"
    },
    {
        "text": "-- after that Madison was pissed that she didn’t use the correct pronoun, so it left the store without paying...",
        "type": "dialogue"
    },
    {
        "type": "dialogue_end"
    },
    {
        "text": "The muted ACDC still seeps thru from outside. In the distance, skaters take air next to Skinhead’s shop. \f                                                                                                     2.",
        "type": "action"
    },
    {
        "type": "dialogue_begin"
    },
    {
        "text": "SOYBOY (O.S.) (CONT'D)",
        "type": "character"
    },
    {
        "text": "-- all the merch just sitting there, waiting months for that show, I couldn’t believe it.",
        "type": "dialogue"
    },
    {
        "type": "dialogue_end"
    },
    {
        "text": "Manbun looks out the window towards Skinhead out front.",
        "type": "action"
    },
    {
        "text": "EXT. SKINHEAD BARBERSHOP - DAY - CONTINUOUS",
        "type": "scene_heading"
    },
    {
        "text": "Hardcore music - kids flipping ollies nearby, a few sit on an old wood picnic table watching Skinhead buzz another skull.",
        "type": "action"
    },
    {
        "type": "dialogue_begin"
    },
    {
        "text": "SKULLKID",
        "type": "character"
    },
    {
        "text": "-- I’m gonna get more air after this! Gonna be wicked, my scar is gonna show, 20 stitches in the raw! Right?",
        "type": "dialogue"
    },
    {
        "type": "dialogue_end"
    },
    {
        "text": "Skinhead glances across the street towards Manbun. Skinhead doesn’t look at the kid he’s buzzing. Manbun and Skinhead catch eyes, staring each other down --",
        "type": "action"
    },
    {
        "text": "A SERIES OF SHOTS:",
        "type": "action"
    },
    {
        "text": "Another espresso froths. Manbun pops a white apron over a new client. A beer cracks open. Skinhead slugs down the beer. Skate punks catch air. Scissors trim a beard, hair drops to the floor. Clippers shave another teen head, hair drops to the pavement. Another coffee. Another beer. More skaters.",
        "type": "action"
    },
    {
        "text": "FADE OUT.",
        "type": "transition"
    },
    {
        "text": "INT. MANBUN BARBERSHOP - EVENING",
        "type": "scene_heading"
    },
    {
        "text": "The Sun is fading. Manbun sweeps up the last of the floor hair. Swipes off the iPad. Picks up his shoulder bag.",
        "type": "action"
    },
    {
        "text": "EXT. MANBUN BARBERSHOP - EVENING - CONTINUOUS",
        "type": "scene_heading"
    },
    {
        "text": "Manbun locks up his shop. Skate punks are departing. Skinhead closes his shop up. Manbun unlocks his townie BIKE. Skinhead gets into his F150, the engine roars to life, black smoke belches out.",
        "type": "action"
    },
    {
        "text": "EXT. STREET - EVENING",
        "type": "scene_heading"
    },
    {
        "text": "Manbun pedals down local streets. Bike lights front & rear. Suddenly, bright vehicle lights pull up behind Manbun.",
        "type": "action"
    },
    {
        "text": "Manbun looks back, concern in his face. \f                                                                                                     3.",
        "type": "action"
    },
    {
        "text": "Manbun takes a turn onto another street. Strong truck lights follow. Manbun pulls up in front of a house. He quickly dismounts, walks his bike into the front yard. The black beast Truck pulls up! Skinhead jumps down. Walks towards Manbun, now at the front door. Manbun fumbles with his keys as Skinhead arrives at the front door. Manbun looks in both directions, anyone nearby? Fear, what next? Skinhead inches closer. Manbun backs up against the door. Skinhead, face to face with Manbun, clenches his fist, then slowly opens his hand and takes Manbun’s keys. Skinhead then passionately mouth kisses Manbun. As they begin to make out - Skinhead inserts the keys into the lock -- They both fall into the House. The front door CLOSES. THUD!",
        "type": "action"
    },
    {
        "text": "FADE TO BLACK.",
        "type": "transition"
    },
    {
        "type": "dialogue_begin"
    },
    {
        "text": "THE END.",
        "type": "character"
    },
    {
        "type": "dialogue"
    },
    {
        "type": "dialogue_end"
    }
].map((obj, i) => ({...obj, index: i}))
const tokens = tokensIn.map((obj, i) => ({...obj, index: i}))

function combineText(text1 = '', text2 = '', offset1, offset2) {
    return text1.slice(0, offset1 || text1.length) + text2.slice(offset2 || 0, text2.length)
}

function combineRange(currentOrderIdIn, nextIdIn, currentOffsetIn, nextOffsetIn) {
    let currentOrderId = currentOrderIdIn
    let nextId = nextIdIn || currentOrderIdIn - 1
    let currentOffset = currentOffsetIn
    let nextOffset = nextOffsetIn

    console.log('nextId', nextId)
    console.log('currentOrderId', currentOrderId)

    if (currentOrderId > nextId) {
        const currentTemp = currentOrderId
        currentOrderId = nextId
        nextId = currentTemp

        const currentOffsetTemp = currentOffset
        currentOffset = nextOffset
        nextOffset = currentOffsetTemp
    }

    console.log('combineRange:------------')
    console.log('currentOrderId', currentOrderId)
    console.log('nextId', nextId)
    // console.log('secondaryOrderId', secondaryOrderId)
    console.log('tokens[currentOrderId]', tokens[currentOrderId])
    console.log('tokens[nextId]', tokens[nextId])

    const nextText = tokens[nextId].text || ''
    const carotPostiion = tokens[currentOrderId].text?.length || 0 
    const currentText = tokens[currentOrderId].text

    // tokens[currentOrderId].text = (tokens[currentOrderId].text || '') + nextText
    tokens[currentOrderId].text = combineText(currentText, nextText, currentOffset, nextOffset)

    console.log('tokens--', tokensIn.slice(0, 10))
    const startRemoveIndex = currentOrderId + 1 // after the current to the and including next
    const forHowManyItems = nextId - currentOrderId
    const newTokens = tokens.toSpliced(startRemoveIndex, forHowManyItems)
    // const newTokens = tokens.toSpliced(currentOrderId, Math.abs(currentOrderId - (nextId || 1)))
    console.log('newTokens--', newTokens.slice(0, 10))

    
    return [newTokens, carotPostiion]
}



combineRange(6, 7, 3, 4)

const a = 'hello this is it'
const aOffset = 5 // thsi should be "hello"
const b = 'no no yes no'
const boffset = 5 // this should be " yes no"
// const res = combineText(a, b, aOffset, boffset)

// console.log("res", res)